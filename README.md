# üåê –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã PostgreSQL - –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ2

![PostgreSQL](https://img.shields.io/badge/PostgreSQL-4169E1?style=for-the-badge&logo=postgresql&logoColor=white)
![DBeaver](https://img.shields.io/badge/DBeaver-372923?style=for-the-badge&logo=dbeaver&logoColor=white)
![SQL](https://img.shields.io/badge/SQL-025E8C?style=for-the-badge&logo=sqlite&logoColor=white)

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–±–æ—Ç–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π:

1) —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö (–®–∞–≥ 1)  
2) –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–æ—Å—å–º–∏ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∞–Ω–∞–ª–∏–∑–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–®–∞–≥ 2)

---

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```

DB2_homework/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ customer.csv
‚îÇ   ‚îú‚îÄ‚îÄ orders.csv
‚îÇ   ‚îú‚îÄ‚îÄ order_items.csv
‚îÇ   ‚îî‚îÄ‚îÄ product.csv
‚îÇ
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ –í–∞–π—Å_–§–µ–¥–æ—Ä_STEP_1.sql
‚îÇ   ‚îî‚îÄ‚îÄ –í–∞–π—Å_–§–µ–¥–æ—Ä_STEP_2.sql
‚îÇ
‚îî‚îÄ‚îÄ img/
    ‚îú‚îÄ‚îÄ ERD.png
    ‚îú‚îÄ‚îÄ T1_v1.png
    ‚îú‚îÄ‚îÄ T1_v2.png
    ‚îú‚îÄ‚îÄ T2.png
    ‚îú‚îÄ‚îÄ T3.png
    ‚îú‚îÄ‚îÄ T4.png
    ‚îú‚îÄ‚îÄ T5.png
    ‚îú‚îÄ‚îÄ T6_–Ω–∞—á–∞–ª–æ.png
    ‚îú‚îÄ‚îÄ T6_–∫–æ–Ω–µ—Ü.png
    ‚îú‚îÄ‚îÄ T7.png
    ‚îî‚îÄ‚îÄ T8.png

```

---

# üß© –®–∞–≥ 1 - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üìç ERD - –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

![ERD](img/ERD.png)

---

## üìç –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

- —Å–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã `customer`, `orders`, `order_items`, `product`
- –≤—ã—è–≤–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã `product_id` –≤ –∏—Å—Ö–æ–¥–Ω–æ–º `product.csv`
- —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `products` —Å –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–µ–π –ø–æ `product_id`
- —Ç–∞–±–ª–∏—Ü–∞ `product` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ "—Å—ã—Ä–æ–π" –∏–º–ø–æ—Ä—Ç
- –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:
  - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π
  - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ NULL
  - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–≤—è–∑–µ–π
  - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ "–≤–∏—Å—è—á–∏—Ö" —Å—Å—ã–ª–æ–∫
- –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã 3 –∑–∞–∫–∞–∑–∞ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º (customer_id 5034)
  - —Å–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–µ–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ order_items
  - –∑–∞—Ç–µ–º —Å–∞–º–∏ –∑–∞–∫–∞–∑—ã
- –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã PK –∏ FK –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏


---

# ü•à –®–∞–≥ 2 - SQL-–∑–∞–ø—Ä–æ—Å—ã (1-8)

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∂–¥–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –∏ –≤–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —É—á—Ç–µ–Ω—ã –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏.

---

# üß™ –ó–∞–¥–∞—á–∞ 1 - –±—Ä–µ–Ω–¥—ã —Å –≤—ã—Å–æ–∫–æ–π —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å—é –∏ –ø—Ä–æ–¥–∞–∂–∞–º–∏

### üìù –ù—é–∞–Ω—Å:
–í –∑–∞–¥–∞—á–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤–æ—è–∫–∞—è —Ç—Ä–∞–∫—Ç–æ–≤–∫–∞: –ø–æ –±—Ä–µ–Ω–¥–∞–º –∏–ª–∏ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º.  
–í—ã–±—Ä–∞–Ω –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ –±—Ä–µ–Ω–¥–∞–º. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ product_id —Ç–∞–∫–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö.  

![T1_v1](img/T1_v1.png)  
![T1_v2](img/T1_v2.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 2 - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –æ–Ω–ª–∞–π–Ω-–∑–∞–∫–∞–∑—ã –ø–æ –¥–Ω—è–º

### üìù –ù—é–∞–Ω—Å:
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω—É–∂–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å `order_date`, –∏–Ω–∞—á–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ç–µ—Ä—è–µ—Ç —Å–º—ã—Å–ª.

![T2](img/T2.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 3 - Senior –≤ IT –∏ Lead –≤ Financial Services

### üìù –ù—é–∞–Ω—Å:
–í–æ–∑—Ä–∞—Å—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑:
```sql
EXTRACT(YEAR FROM age(CURRENT_DATE, dob))
````

–≠—Ç–æ –≤–æ–∑—Ä–∞—Å—Ç "–Ω–∞ —Å–µ–≥–æ–¥–Ω—è".
–ï—Å–ª–∏ –±—ã —Ç—Ä–µ–±–æ–≤–∞–ª—Å—è –≤–æ–∑—Ä–∞—Å—Ç –Ω–∞ 2017 –≥–æ–¥, –Ω—É–∂–Ω–æ:

```sql
EXTRACT(YEAR FROM age(DATE '2017-01-01', dob))
```

![T3](img/T3.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 4 - –±—Ä–µ–Ω–¥—ã Financial Services, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —É IT

### üìù –ù—é–∞–Ω—Å:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `EXCEPT`, —á—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–∑–Ω–æ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤.
ORDER BY –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –∏—Ç–æ–≥–æ–≤–æ–º—É select.

![T4](img/T4.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 5 - –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Ç–æ–ø-–±—Ä–µ–Ω–¥–æ–≤ —Å valuation –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ

### üìù –ù—é–∞–Ω—Å:

–°—Ä–µ–¥–Ω–µ–µ –ø–æ —à—Ç–∞—Ç—É —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ **–≤—Å–µ–º –∫–ª–∏–µ–Ω—Ç–∞–º**, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º –±—Ä–µ–Ω–¥–æ–≤.
–ü–æ—ç—Ç–æ–º—É —Å—Ä–µ–¥–Ω–µ–µ –≤—ã–Ω–µ—Å–µ–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ CTE.

![T5](img/T5.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 6 - –≤–ª–∞–¥–µ–ª—å—Ü—ã –∞–≤—Ç–æ, –Ω–µ Mass Customer, –±–µ–∑ –æ–Ω–ª–∞–π–Ω-–∑–∞–∫–∞–∑–æ–≤

### üìù –ù—é–∞–Ω—Å:

"–ü–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥" —Ç—Ä–∞–∫—Ç—É–µ–º –∫–∞–∫ 2017 –≥–æ–¥, —Ç–∞–∫ –∫–∞–∫ –≤–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 2017.
–ï—Å–ª–∏ –±—ã –Ω—É–∂–Ω–æ –±—ã–ª–æ —Å—Ç—Ä–æ–≥–æ "max(order_date) –º–∏–Ω—É—Å –≥–æ–¥", –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –±—ã –∏–Ω—Ç–µ—Ä–≤–∞–ª.

### –ù–∞—á–∞–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

![T6\_n1](img/T6_–Ω–∞—á–∞–ª–æ.png)

### –ö–æ–Ω–µ—Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

![T6\_n2](img/T6_–∫–æ–Ω–µ—Ü.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 7 - IT-–∫–ª–∏–µ–Ω—Ç—ã, –∫—É–ø–∏–≤—à–∏–µ —Ä–æ–≤–Ω–æ 2 –∏–∑ —Ç–æ–ø-5 Road-–ø—Ä–æ–¥—É–∫—Ç–æ–≤

### üìù –ù—é–∞–Ω—Å:

–ó–∞–¥–∞–Ω–∏–µ –±—ã–ª–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ "–∫—É–ø–∏–ª–∏ 2 –∏–∑ 5".
–ú—ã —Ç—Ä–∞–∫—Ç—É–µ–º —ç—Ç–æ –∫–∞–∫ **—Ä–æ–≤–Ω–æ 2 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–∞**.
–ï—Å–ª–∏ –±—ã —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å "–Ω–µ –º–µ–Ω–µ–µ 2", —É—Å–ª–æ–≤–∏–µ –±—ã–ª–æ –±—ã –¥—Ä—É–≥–∏–º.

![T7](img/T7.png)

---

# üß™ –ó–∞–¥–∞—á–∞ 8 - –∫–ª–∏–µ–Ω—Ç—ã IT –∏ Health —Å –≤—ã—Å–æ–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –≤—ã—Ä—É—á–∫–æ–π

### üìù –ù—é–∞–Ω—Å:

–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ Approved, –æ–Ω–ª–∞–π–Ω-–∑–∞–∫–∞–∑—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è.

![T8](img/T8.png)

---
## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ  
- [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)  
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)  
- [–®–∞–≥ 1 - —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î](#—à–∞–≥-1---—Å–æ–∑–¥–∞–Ω–∏–µ-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã-–±–¥)  
- [–®–∞–≥ 2 - SQL-–∑–∞–ø—Ä–æ—Å—ã](#—à–∞–≥-2---sql-–∑–∞–ø—Ä–æ—Å—ã)  
  - [–ó–∞–¥–∞—á–∞ 1](#–∑–∞–¥–∞—á–∞-1)  
  - [–ó–∞–¥–∞—á–∞ 2](#–∑–∞–¥–∞—á–∞-2)  
  - ... –∏ —Ç. –¥.

